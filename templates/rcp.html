<!DOCTYPE html>
<html>

<head>
    <title>Rock Paper Scissors Game</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            background-color: #2b2b2b;
        }

        h1 {
            color: white;
        }

        #result {
            margin-bottom: 20px;
            font-size: 18px;
            font-weight: bold;
            color: white;
        }

        #score {
            margin-bottom: 20px;
            font-size: 16px;
            color: white;
        }

        #final_score {
            margin-bottom: 30px;
            font-size: 20px;
            color: blue;
        }

        .button-container {
            margin: 10px;
        }

        .button-container button {
            padding: 10px 20px;
            margin: 5px;
            background-color: #4CAF50;
            color: #fff;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .button-container button:hover {
            background-color: #45a049;
        }

        .emoji {
            font-size: 48px;
        }

        #dog-image {
            width: 30%;
        }

        #container {
            display: flex;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
            height: calc(100vh - 10px);
        }

        #game {
            width: 50%;
        }

        #game-over {
            /* display: none;
      margin-top: 20px;
      font-size: 20px;
      font-weight: bold;
      color: #333; */
            width: 50%;
        }

        #clear-screen {
            display: none;
            margin-top: 20px;
            font-size: 20px;
            font-weight: bold;
            color: #333;
        }

        #clear-screen-button {
            padding: 10px 20px;
            background-color: red;
            color: #fff;
            border: none;
            border-radius: 40px;
            cursor: pointer;
            margin-top: 10px;
            text-align: center;
            width: 20%;

        }

        #past_page {
            display: none;
            margin-top: 20px;
            font-size: 20px;
            font-weight: bold;
            color: white;
        }
        .view_ranking {
            display: none;
            text-align: left;
        }

        #ranking
        {
            position: absolute;
            top: 7px;
            right: 10px;
        }
        #uname
        {
            position: absolute;
            top: 10px;
            right: 180px;
            color: white;
        }
        #img1
        {
            
            position: absolute;
            display:none;
            top: 280px;
            left: 300px;
        }
        #img2
        {
           position: absolute;
            display:none;
            top: 280px;
            left: 300px;
        } 
        #img3
        {
            position: absolute;
            display:none;
            top: 280px;
            left: 300px;
        } 
        #img4
        {
            position: absolute;
            display:none;
            top: 280px;
            left: 550px;
        }
        #img5
        {
            position: absolute;
            display:none;
            top: 280px;
            left: 550px;
        } 
        #img6
        {
            position: absolute;
            display:none;
            top: 280px;
            left: 550px;
        } 

        #m_position
        {
            position: absolute;
            top: 200px;
            left: 300px;
        } 
        #c_position
        {
            position: absolute;
            top: 200px;
            left: 350px;
        } 
        #vs
        {
            position: absolute;
            top: 200px;
            left: 350px;
        } 



        #bgm
        {   
          position: absolute;
          top: 10px;
          left: 10px;
          width: 90px;
          height: 20px;
          font-size:90%;
          display: flex;
          justify-content: center; /* Í∞ÄÎ°ú Í∞ÄÏö¥Îç∞ Ï†ïÎ†¨ */
          align-items: center; /* ÏÑ∏Î°ú Í∞ÄÏö¥Îç∞ Ï†ïÎ†¨ */
        }

        .login_music{
            display: none;
        }
        #LOGOUT
        {
            position: absolute;
            top: 7px;
            right: 100px;
        }
    </style>
</head>

<body>
    <!-- audio class -->

    <audio class="login_music" controls>
        <source src="/static/login_music.mp3" type="audio/mpeg">
      </audio>  
    <button type="button" class="btn "onclick="music_play()" id = "bgm">BGM ON</button>
    <h1>Ïª¥Ìì®ÌÑ∞Î•º Ïù¥Í≤®Î≥¥Ïûê~</h1>
    <h1 id="m_position"> player&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;computer </h1>
    <p1 id = uname> PLAYER :  {{session['user_id']}}</p1>
    <button type="button" id="ranking" class="difficulty-button" onclick="location.href='/rcprank'"
    style=" background-color: #007bff; color: #fff; border: none; border-radius: 4px; cursor: pointer; margin-top: 5px; text-align: center;">üèÜÎû≠ÌÇπ
    </button><br><br>

    <button type="button" id="LOGOUT" class="difficulty-button" onclick="location.href='/logout'"
    style=" background-color: #007bff; color: #fff; border: none; border-radius: 4px; cursor: pointer; margin-top: 5px; text-align: center;">Î°úÍ∑∏ÏïÑÏõÉ
    </button>

    <div id="container">
        <div id="game">

            <div id="result"></div>
            <div id="score"></div>
            <div id="final_score"></div>
            <div class="button-container">
                <button onclick="play('rock')">‚úä</button>
                <button onclick="play('paper')">‚úã</button>
                <button onclick="play('scissors')">‚úåÔ∏è</button>
            </div>

            <div id="past_page"></div>
            <button type="button" onclick="location='/mainpage'" style="padding: 10px 20px; background-color: green; color: #fff; border: none; border-radius: 40px; 
                cursor: pointer; margin-top: 10px; text-align: center; width:20%;">
                Ïù¥Ï†Ñ ÌéòÏù¥ÏßÄ
            </button>

            <div id="clear-screen"></div>
            <button id="clear-screen-button" onclick="resetGame()">
                Ï†êÏàò Ï¥àÍ∏∞Ìôî
            </button>

            <div id="game-over"></div>
            <button class="hidden" type="button" onclick="transtopython()" style="padding: 10px 20px; background-color: gray; color: #fff; border: none; border-radius: 40px; 
                cursor: pointer; margin-top: 10px; text-align: center; width:100%;">
                Ï†êÏàòÏ†úÏ∂ú
            </button>

        </div>

        <img src="/static/rock.png"  width="600" height="500">
        <img id="img1" class = "img1" src="/static/img1.png" width="100" height="100">
        <img id="img2" class = "img2" src="/static/img2.png" width="100" height="100">
        <img id="img3" class = "img3" src="/static/img3.png" width="100" height="100">

        
        <img id="img4" class = "img4" src="/static/img1.png" width="100" height="100">
        <img id="img5" class = "img5" src="/static/img2.png" width="100" height="100">
        <img id="img6" class = "img6" src="/static/img3.png" width="100" height="100">

        


    </div>

    <script>
        var playerScore = 0;
        var computerScore = 0;
        var final_score = 0;
        var round = 0;
        var flag = 0;
        var difficultyContainer = document.querySelector('.hidden');
        difficultyContainer.style.display = 'none';
        var uid = '{{uid}}';
        //Ï£ºÎ®π
        function im1(playerChoice){
            var difficultyContainer1 = document.querySelector('.img1');
            difficultyContainer1.style.display = 'None';
            var difficultyContainer2 = document.querySelector('.img2');
            difficultyContainer2.style.display = 'None';
            var difficultyContainer3 = document.querySelector('.img3');
            difficultyContainer3.style.display = 'None';

            if(playerChoice=='rock')
            {difficultyContainer1.style.display = 'block';}
            else if(playerChoice=='scissors')
            {difficultyContainer2.style.display = 'block';}
            else if(playerChoice=='paper')
            {difficultyContainer3.style.display = 'block';}
            
        }
        function im2(computerChoice){
            var difficultyContainer4 = document.querySelector('.img4');
            difficultyContainer4.style.display = 'None';
            var difficultyContainer5 = document.querySelector('.img5');
            difficultyContainer5.style.display = 'None';
            var difficultyContainer6 = document.querySelector('.img6');
            difficultyContainer6.style.display = 'None';

            if(computerChoice=='rock')
            {difficultyContainer4.style.display = 'block';}
            else if(computerChoice=='scissors')
            {difficultyContainer5.style.display = 'block';}
            else if(computerChoice=='paper')
            {difficultyContainer6.style.display = 'block';}
            
        }

        
        function play(playerChoice) {
            var choices = ['rock', 'paper', 'scissors'];
            var computerChoice = choices[Math.floor(Math.random() * choices.length)];
            im1(playerChoice);
            im2(computerChoice);
            round++;
            var resultText = 'ÏäπÎ∂Ä ' + round + 'Î≤àÏß∏  : ';
            if (round <= 20) {
                if (playerChoice === computerChoice) {
                    resultText += 'Î¨¥ÏäπÎ∂ÄÎã§!!';
                    final_score += 1;
                } else if (
                    (playerChoice === 'rock' && computerChoice === 'scissors') ||
                    (playerChoice === 'paper' && computerChoice === 'rock') ||
                    (playerChoice === 'scissors' && computerChoice === 'paper')
                ) {
                    playerScore++;
                    resultText += 'ÎÇ¥Í∞Ä Ïù¥ÍπÄ! ';
                    final_score += 3;
                } else {
                    computerScore++;
                    resultText += 'ÎÇò Ï°åÏñ¥„Öú! ';
                }

                document.getElementById('result').textContent = resultText;
                document.getElementById('score').textContent = 'ÎÇ¥ ÏäπÎ¶¨ : ' + playerScore + ' - ÏÉÅÎåÄ ÏäπÎ¶¨ : ' + computerScore;
                var difficultyContainer = document.querySelector('.hidden');
                difficultyContainer.style.display = 'none';
            }
            else if (round > 20) {
                var finalResult = '';
                if (playerScore > computerScore) {
                    finalResult = 'Ïù¥Í±∏ Ïù¥Í≤ºÎÑ§?.';
                } else if (playerScore < computerScore) {
                    finalResult = 'ÌÅ¨ÌÅ¨ÌÅ¨. Ï°åÏñ¥?';
                } else {
                    finalResult = 'Ïù¥Í≤å Î¨¥ÏäπÎ∂ÄÏïº?!.';
                }

                document.getElementById('result').textContent = finalResult;
                document.getElementById('final_score').textContent = 'ÎÇ¥ ÏµúÏ¢Ö Ï†êÏàò : ' + final_score;

                var difficultyContainer = document.querySelector('.hidden');
                difficultyContainer.style.display = 'block';
            }
        }
        function resetGame() {
            playerScore = 0;
            computerScore = 0;
            final_score = 0;
            flag = 0;
            round = 0;
            im1('ss');
            im2('ss');
            document.getElementById('result').textContent = '';
            document.getElementById('score').textContent = '';
            document.getElementById('game-over').textContent = '';
            document.getElementById('final_score').textContent = '';

            var difficultyContainer = document.querySelector('.hidden');
            difficultyContainer.style.display = 'none';

            var buttons = document.getElementsByTagName('button');
            for (var i = 0; i < buttons.length; i++) {
                buttons[i].disabled = false;
            }
        }

        function transtopython()
        {
            fetch('/rcpscore', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ final_score: final_score, uid:uid  })
                })
                .then(response => response.json())
                .then(result => {
                    console.log(result.result)
                //console.log('Îç∞Ïù¥ÌÑ∞Í∞Ä ÏÑ±Í≥µÏ†ÅÏúºÎ°ú Ï†ÑÏÜ°ÎêòÏóàÏäµÎãàÎã§.');
                //document.getElementById("error").textContent = "[Ï†êÏàòÏ†ÄÏû•ÏôÑÎ£å.]";
                })
                .catch(error => {
                //console.error('Îç∞Ïù¥ÌÑ∞ Ï†ÑÏÜ° Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌïòÏòÄÏäµÎãàÎã§.', error);
                //document.getElementById("error").textContent = "[Ï†êÏàòÏ†ÄÏû•Ïã§Ìå®.]";
                });
        }
        function music_play(){
            const audio = document.querySelector('.login_music');
            var button = document.getElementById("bgm");
            if (button.textContent === "BGM ON") {
              button.textContent = "BGM OFF";
              audio.play();
            } else {
              button.textContent = "BGM ON";
              audio.pause();
            }
        }

        
        // function transtopython() {
        //     if (flag == 0){
        //     fetch('/rcpscore', {
        //         method: 'POST',
        //         headers: {
        //             'Content-Type': 'application/json'
        //         },
        //         body: JSON.stringify({ final_score: final_score, uid:uid })
        //     })
        //         .then(response => response.json())
        //         .then(result => {
        //             console.log(result.result)
        //             document.getElementById("error").textContent = "[Ï†êÏàòÏ†ÄÏû•ÏôÑÎ£å.]";
        //         })
        //         .catch(error => {
        //             document.getElementById("error").textContent = "[Ï†êÏàòÏ†ÄÏû•Ïã§Ìå®.]";
        //         });
        //         flag = 1;
        //     }
        //     // window.location.href = "/main";// Í≤åÏûÑ Ï¢ÖÎ£åÏãú ÎÑòÏñ¥Í∞à ÌôîÎ©¥ ÎÑ£Ïñ¥Ï£ºÍ∏∞
        // }
    </script>
</body>

</html>